{% extends "base.html" %}
{% block content %}
<h1>ğŸ  Smart Dorm Allocation System</h1>

<!-- DASHBOARD STATS (always visible) -->
<div class="dashboard">
    <div class="stat-card">
        <h2>{{ students|length }}</h2>
        <p>Total Students</p>
    </div>
    <div class="stat-card">
        <h2>{{ dorms|length }}</h2>
        <p>Total Dorms</p>
    </div>
    <div class="stat-card">
        <h2>{{ total_capacity }}</h2>
        <p>Total Capacity</p>
    </div>
    <div class="stat-card {% if students|length > total_capacity %}warning{% endif %}">
        <h2>{{ (students|length - total_capacity) if students|length > total_capacity else 0 }}</h2>
        <p>Overflow Risk</p>
    </div>
</div>

<!-- ADMIN QUICK ACTIONS (login required) -->
{% if is_admin %}
<h2>ğŸ‘‘ Admin Control Panel</h2>
<div class="quick-actions">
    <form method="post" action="{{ url_for('load_sample') }}" style="display:inline; margin-right: 10px;">
        <button type="submit" class="btn-primary">ğŸ’¾ Load Sample Data</button>
    </form>
    <a href="{{ url_for('charts') }}" class="btn-primary">ğŸ“Š Live Charts</a>
    <a href="{{ url_for('compare_strategies') }}" class="btn-primary">âš¡ Compare Strategies</a>
    <a href="{{ url_for('run_allocation') }}" class="btn-primary">ğŸš€ Run Allocation</a>
    <a href="{{ url_for('admin_logs') }}" class="btn-secondary">ğŸ“‹ Audit Logs</a>
</div>

<h3>ğŸš€ Quick Stats</h3>
<div class="activity" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
    <div class="stat-card">
        <h4>Ready for Allocation</h4>
        <p>{{ dorms|length > 0 and students|length > 0 and 'âœ… YES' or 'âš ï¸ Add data first' }}</p>
    </div>
    <div class="stat-card">
        <h4>High Priority Students</h4>
        <p>{{ students|selectattr('priority', '>', '0')|list|length }}</p>
    </div>
</div>
{% else %}
<!-- PUBLIC VIEWER MODE -->
<div style="background: #fff3cd; padding: 30px; border-radius: 10px; border-left: 5px solid #ffc107; margin: 20px 0;">
    <h3>ğŸ”’ Welcome to Dorm Allocation System</h3>
    <p><strong>Admin credentials:</strong></p>
    <ul style="font-size: 16px;">
        <li><strong>Username:</strong> <code>admin</code></li>
        <li><strong>Password:</strong> <code>password123</code></li>
    </ul>
    <p>Login to access full features including:</p>
    <ul>
        <li>ğŸ‘¥ Student & dorm management</li>
        <li>ğŸš€ Advanced allocation algorithms</li>
        <li>ğŸ“Š Live analytics dashboard</li>
        <li>ğŸ’¾ Data import/export</li>
        <li>ğŸ“‹ Complete audit trail</li>
    </ul>
    <a href="{{ url_for('login') }}" class="btn-primary" style="font-size: 18px; padding: 15px 30px;">ğŸ” Admin Login</a>
</div>
{% endif %}
{% endblock %}
